# Simulation: ./beepmbp inputfile="examples/EX5c.toml" mode="sim" 

# Inference: mpirun -n 20 ./beepmbp inputfile="examples/EX5c.toml" mode="ml" algorithm="cmaes" nsample_final=1000   posterior_particle=200 nparticle=200 ngeneration=250 invT=10000

description = "Here time variation in the external force of infection is added to the analysis (note due to confounding with the reproduction number it is not usually possible to estimate this from the data, but incorporating it will lead to a more accurate estimate for reproduction number). A piecewise linear spline is used to represent time variation in the reproduction number R. An SIR model is assumed with a constant external force of infection. Data consists of the weekly number of S→I infections and I→R recoveries. The reproduction number spline (determined by a series of model parameters at specified time points) and infection period are inferred from this data." 

time_format = "year-month-day"
start = "2020-01-01"
end = "2021-06-09"

time_labels = [{name="Lockdown", time="2020-03-23"},{name="Lockdown 2", time="2020-11-05"},{name="Lockdown 3", time="2021-01-06"}]

datadir = "examples/Data_EX5c"
outputdir = "analysis/Output_EX5c"

comps = [
{name="S"},
{name="I", dist="Exp", mean_value="10", inf_value="1", mean_prior="Uniform(5,15)"},
{name="R"}
]

trans = [
{from="S", to="I", infection="yes"},
{from="I", to="R"}
] 

R_spline = [{ param="[R:R_spline.csv]", value="[value:R_spline.csv]", prior="[prior:R_spline.csv]", bp="[bp:R_spline.csv]", smooth_type="log_smooth", smooth="[smooth:R_spline.csv]"}]

efoi_spline	= [{ param="efoi", value="1", bp="[bp:efoi_spline.csv]", factor="[factor:efoi_spline.csv]"}]

areas = "population.csv"

data_tables = [
{type="transition", observation="S->I", timestep="7", obsmodel="scale", file="S-I.csv"},
{type="transition", observation="I->R", timestep="7", obsmodel="scale", file="I-R.csv"}
]

state_outputs = [
{plot_name="Dynamics", type="population", observation="S", line_colour="green"},
{plot_name="Dynamics", type="population", observation="I", line_colour="red"},
{plot_name="Dynamics", type="population", observation="R", line_colour="blue"}
]

plot_param_values = "true"

